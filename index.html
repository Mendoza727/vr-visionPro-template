<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Hand Tracking! • A-Frame</title>
    <meta name="description" content="Hand Tracking! • A-Frame" />
    <script src="https://cdn.jsdelivr.net/npm/aframe@1.5.0/dist/aframe-master.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-environment-component@1.3.4/dist/aframe-environment-component.min.js"></script>
</head>

<body>
    <a-scene environment="preset: forest" physics="gravity: -9.8">

        <!-- Agrega el modelo FBX dentro de un elemento a-entity -->
        <a-entity id="draggableFbxModel" position="0 1.5 -0.5">
            <a-entity
                fbx-model="src: url(models/saxenda.fbx); scale: 0.5 0.5 0.5;"
                material="color: #fcdab7;">
            </a-entity>
        </a-entity>

        <!-- Componente grabbable personalizado -->
        <script>
            AFRAME.registerComponent('grabbable', {
                init: function () {
                    this.el.addEventListener('mousedown', this.onGrabStart.bind(this));
                    this.el.addEventListener('mouseup', this.onGrabEnd.bind(this));
                    this.el.addEventListener('mouseleave', this.onGrabEnd.bind(this));
                    this.grabbing = false;
                },

                onGrabStart: function (evt) {
                    this.grabbing = true;
                    this.grabbedElement = this.el;
                },

                onGrabEnd: function () {
                    this.grabbing = false;
                    this.grabbedElement = null;
                },

                tick: function () {
                    if (this.grabbing && this.grabbedElement) {
                        var handPosition = this.el.object3D.position;
                        this.grabbedElement.object3D.position.copy(handPosition);
                    }
                }
            });
        </script>

        <!-- Aplica el componente grabbable al elemento que contiene el modelo FBX -->
        <a-entity id="draggableFbxModelWrapper" grabbable>
            <a-entity
                fbx-model="src: url(models/saxenda.fbx); scale: 0.5 0.5 0.5;"
                material="color: #fcdab7;">
            </a-entity>
        </a-entity>
    </a-scene>
</body>

</html>
